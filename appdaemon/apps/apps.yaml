---
hello_world:
  module: hello
  class: HelloWorld

######################################################
###################### DEFAULT #######################
######################################################
default:
  module: automoli
  class: AutoMoLi
  disable_switch_entities:
    - input_boolean.home_automation_disabled
    #- input_boolean.debugging
  disable_switch_states: "on"
  only_own_events: false
  motion_state_on: "on"
  motion_state_off: "off"
  daytimes:
    - { starttime: "00:00", name: "allday", light: 100 }
  block_on_switch_states: "on"
  block_off_switch_states: "on"
  debug_log: False

######################################################
####################### TO DO ########################
######################################################

# anna_bedroom:

######################################################
##################### DOWNSTAIRS #####################
######################################################
playroom:
  module: automoli
  class: AutoMoLi
  delay: 900
  lights:
    - switch.downstairs_playroom_lights
  motion:
    - binary_sensor.downstairs_playroom_motion
    - binary_sensor.epson_printing
  warning_flash: True

office:
  module: automoli
  class: AutoMoLi
  # Using Occupancy sensor so turn off lights right when occupancy clears
  # Note: delay = 0 means AutoMoLi will never turn off the lights, so setting to 1s
  delay: 600
  # delay_outside_events needs to be longer, otherwise lights will just flash when turned on manually
  delay_outside_events: 600
  transition_on_daytime_switch: true
  lights:
    - light.office_light
    - switch.office_lamp
  motion: 
    - binary_sensor.office_motion_aqara
  block_off_switch_entities:
    - binary_sensor.office_motion_occupancy
  daytimes:
    - { starttime: "sunrise+01:00", name: "morning", light: 70 }
    - { starttime: "12:00", name: "noon", light: 50 }
    - { starttime: "sunset-01:00", name: "evening", light: 70 }
    - { starttime: "sunset+01:00", name: "night", light: 100 }
  warning_flash: True

laundry:
  module: automoli
  class: AutoMoLi
  delay: 900
  lights:
    - switch.laundry_room_lights
  motion:
    - binary_sensor.inside_garage_door
    - binary_sensor.laundry_room_motion

kitchen:
  module: automoli
  class: AutoMoLi
  delay: 1800
  lights:
    - switch.kitchen_lights
  lights_off:
    - switch.kitchen_island_lights
    - switch.kitchen_nook_lights
    - light.family_room_light
    - switch.family_room_lamp
    - switch.outside_powder_lights
  motion:
    - binary_sensor.inside_garage_door
    - binary_sensor.downstairs_back_stairs_motion
    - binary_sensor.front_entry_motion
    - binary_sensor.entry_hallway_motion
    - binary_sensor.kitchen_nook_motion
    - binary_sensor.kitchen_desk_motion
    - binary_sensor.kitchen_occupancy
    - binary_sensor.kitchen_table_vibration
  block_on_switch_entities:
    - input_boolean.kitchen_recently_off
    - input_boolean.movie_night
  block_off_switch_entities:
    - input_boolean.dining_room_in_use
  warning_flash: True

kitchen_nook:
  module: automoli
  class: AutoMoLi
  delay: 1800
  lights:
    - switch.kitchen_nook_lights
  motion:
    - binary_sensor.kitchen_table_vibration
  block_on_switch_entities:
    - input_boolean.movie_night

powder_room:
  module: automoli
  class: AutoMoLi
  disable_switch_entities:
    - input_boolean.home_automation_disabled
    # Ignore motion right after open door (to avoid reset of shorten delay)
    - binary_sensor.powder_door_recently_opened
  delay: 300
  lights:
    - switch.powder_room_lights
  motion:
    # - binary_sensor.inside_powder_room_motion
    # - binary_sensor.outside_powder_room_motion
    - binary_sensor.lumi_lumi_sensor_motion_aq2_ias_zone
  block_off_switch_entities:
    - binary_sensor.powder_room_door
  block_off_switch_states: "off"
  shorten_delay:
    - binary_sensor.powder_room_door
  warning_flash: True

########  Just turn off, if turned on manually ########
outside_pantry:
  module: automoli
  class: AutoMoLi
  delay: 900
  lights:
    - switch.outside_pantry_light
  block_off_switch_entities:
    - input_boolean.dining_room_in_use

outside_powder_room:
  module: automoli
  class: AutoMoLi
  delay: 1800
  lights:
    - switch.outside_powder_lights
  block_off_switch_entities:
    - input_boolean.dining_room_in_use

entryway:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.entry_way_light
  motion:
    - binary_sensor.front_door
  block_off_switch_entities:
    - input_boolean.dining_room_in_use
    - binary_sensor.front_door
  daytimes:
    - { starttime: "sunset-01:00", name: "evening", light: 100 }
    - { starttime: "sunrise+01:00", name: "morning", light: 0 }

powder_room_fan:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.powder_room_fan

family_room_fireplace:
  module: automoli
  class: AutoMoLi
  delay: 7200
  lights:
    - switch.downstairs_fireplace

######################################################
###################### UPSTAIRS ######################
######################################################

master_hall:
  module: automoli
  class: AutoMoLi
  delay: 180
  delay_outside_events: 600
  lights:
    - switch.master_hall_lights
  motion:
    - binary_sensor.entry_hallway_motion
    - binary_sensor.master_bedroom_motion
    - binary_sensor.upstairs_back_stairs_motion

kids_hall:
  module: automoli
  class: AutoMoLi
  delay: 180
  delay_outside_events: 600
  lights:
    - switch.kids_hall_lights
  motion:
    - binary_sensor.upstairs_back_stairs_motion

master_bathroom:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.bathroom_bath_light
    - switch.master_toilet_light
  lights_off:
    - switch.bathroom_vanity_lights
    - switch.shower_light
    - switch.outside_shower_light
  motion:
    - binary_sensor.master_bathroom_motion
    - binary_sensor.toilet_motion
    # Special template that checks for both bedroom motion and 
    # that it is between 6am and 11pm
    - binary_sensor.bedroom_motion_for_bathroom_lights
  shorten_delay:
    - binary_sensor.julie_in_bed
    - binary_sensor.matt_in_bed
  humidity: sensor.master_shower_humidity
  humidity_threshold: 87

master_bathroom_vanity:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.bathroom_vanity_lights
  motion:
    - binary_sensor.master_bathroom_motion
    - binary_sensor.toilet_motion
    # Special template that checks for both bedroom motion and 
    # that it is between 6am and 11pm
    - binary_sensor.bedroom_motion_for_bathroom_lights
  shorten_delay:
    - binary_sensor.julie_in_bed
    - binary_sensor.matt_in_bed
  daytimes:
    - { starttime: "sunrise-01:00", name: "day", light: 100 }
    - { starttime: "22:00", name: "night", light: 0 }
  humidity: sensor.master_shower_humidity
  humidity_threshold: 87

master_bedroom:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.master_lights
  motion:
    - binary_sensor.master_bedroom_motion
  shorten_delay:
    - binary_sensor.julie_in_bed
    - binary_sensor.matt_in_bed
  block_on_switch_entities:
    - binary_sensor.julie_in_bed
    - binary_sensor.matt_in_bed
    # Using bathroom motion as an indicator that I was just in the bathroom,
    # and likely leaving the bedroom, not entering
    - binary_sensor.master_bath_recent_motion
  daytimes:
    - { starttime: "sunrise-01:00", name: "day", light: 100 }
    - { starttime: "23:00", name: "night", light: 0 }

master_shower:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.shower_light
    - switch.shower_fan
    - switch.outside_shower_light
  motion:
    - binary_sensor.master_bathroom_humidity_rising_aqara
    - binary_sensor.master_bathroom_temp_rising_aqara
  humidity: sensor.master_shower_humidity
  block_off_switch_entitities:
    - switch.bathroom_bath_light
  humidity_threshold: 87

########  Just turn off, if turned on manually ########
guestroom:
  module: automoli
  class: AutoMoLi
  disable_switch_entities:
    - input_boolean.home_automation_disabled
    - input_boolean.guestroom_in_use
  delay: 900
  lights:
    - switch.guest_bedroom_lights

master_lamps:
  module: automoli
  class: AutoMoLi
  delay: 1800
  lights:
    - light.julie_bedside_lamp
    - light.matt_bedside_lamp

master_toilet_fan:
  module: automoli
  class: AutoMoLi
  delay: 600
  lights:
    - switch.master_toilet_fan

master_fireplace:
  module: automoli
  class: AutoMoLi
  delay: 7200
  lights:
    - switch.master_fireplace

######################################################
####################### STAIRS #######################
######################################################

front_stairs:
  module: automoli
  class: AutoMoLi
  delay: 180
  delay_outside_events: 600
  lights:
    - switch.front_stairs_lights
  motion:
    - binary_sensor.entry_hallway_motion
    - binary_sensor.master_bedroom_motion
    - binary_sensor.front_door
  block_on_switch_entities:
    - binary_sensor.upstairs_back_stairs_recent_motion
  block_off_switch_entities:
    - input_boolean.dining_room_in_use

back_stairs:
  module: automoli
  class: AutoMoLi
  delay: 180
  delay_outside_events: 600
  lights:
    - switch.back_stairs_lights
  motion:
    - binary_sensor.upstairs_back_stairs_motion
    - binary_sensor.downstairs_back_stairs_motion

######################################################
###################### OUTSIDE #######################
######################################################

garage:
  module: automoli
  class: AutoMoLi
  delay: 300
  lights:
    - switch.garage_lights
  motion:
    - binary_sensor.outside_garage_door
    - binary_sensor.inside_garage_door
    - binary_sensor.garage_motion
    - binary_sensor.garage_door_open
  # As long as any of the doors are open, don't turn off lights
  # even if there isn't motion
  block_off_switch_entities:
    - binary_sensor.garage_door_open
    - binary_sensor.outside_garage_door
    - binary_sensor.inside_garage_door

dogrun:
  module: automoli
  class: AutoMoLi
  delay: 300
  lights:
    - switch.dog_run_light
  motion:
    - binary_sensor.outside_garage_door
  daytimes:
    - { starttime: "sunset-01:00", name: "evening", light: 100 }
    - { starttime: "sunrise+01:00", name: "morning", light: 0 }
  block_off_entitites:
    - binary_sensor.outside_garage_door

front_porch:
  module: automoli
  class: AutoMoLi
  delay: 900
  lights:
    - switch.front_porch_lights
  motion:
    - binary_sensor.front_door
    - binary_sensor.garage_door_open
  daytimes:
    - { starttime: "sunset-01:00", name: "evening", light: 100 }
    - { starttime: "sunrise+01:00", name: "morning", light: 0 }

back_patio:
  module: automoli
  class: AutoMoLi
  delay: 900
  lights:
    - switch.patio_lights
  motion:
    - binary_sensor.kitchen_sliding_door
  daytimes:
    - { starttime: "sunset-01:00", name: "evening", light: 100 }
    - { starttime: "sunrise+01:00", name: "morning", light: 0 }
  block_off_entitites:
    - binary_sensor.kitchen_sliding_door
