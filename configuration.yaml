# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

homeassistant:
  packages:
    mqtt_sensors: !include mqtt_sensors.yaml
  # Tesla integration
  customize_glob:
    'lock.tesla_*_door_lock':
      friendly_name: Doors
    'lock.tesla_*_charger_door_lock':
      friendly_name: Charger Door
    'lock.tesla_*_frunk_lock':
      friendly_name: Frunk
    'lock.tesla_*_trunk_lock':
      friendly_name: Trunk
    'binary_sensor.tesla_*_parking_brake_sensor':
      friendly_name: Parking Brake

# Debugging
logger:
  default: warning

# Setup input variables for all entitites
input_text: !include input_text.yaml
timer: !include timer.yaml
input_boolean: 
  guestroom_in_use:
    name: "Guestroom In Use"
  dining_room_in_use:
    name: "Dining Room In Use"
  null_boolean:
    name: "Null Boolean"
input_number:
  master_in_bed:
    name: "Count in Master Bed"
    initial: 0
    min: 0
    max: 2
  office_motion_count:
    name: "Office Motion Count"
    initial: 0
    min: 0
    max: 10
  parents_home:
    name: "Count of Parents at Home"
    initial: 0
    min: 0
    max: 2
  null_number:
    name: "Null Number"
    initial: 0
    min: 0
    max: 10

# Add support for templating in lovelace
lovelace_gen:
lovelace:
  mode: yaml
  resources:
    - url: /hacsfiles/home-assistant-sun-card/home-assistant-sun-card.js
      type: module
    - url: /hacsfiles/lovelace-auto-entities/auto-entities.js
      type: module
    - url: /hacsfiles/lovelace-card-templater/lovelace-card-templater.js
      type: module
    - url: /hacsfiles/ha-floorplan/floorplan.js
      type: module
    - url: /hacsfiles/mini-graph-card/mini-graph-card-bundle.js
      type: module
    - url: /hacsfiles/lovelace-multiple-entity-row/multiple-entity-row.js
      type: module
    - url: /hacsfiles/lovelace-template-entity-row/template-entity-row.js
      type: module
    - url: /hacsfiles/timer-bar-card/timer-bar-card.js
      type: module

# Envisalink Alarm Panel
envisalink: !include envisalink.yaml

# Alexa integration with Philips Hue emulated bridge  
emulated_hue:
  listen_port: 80
  expose_by_default: false
  entities:
    switch.tesla_climate:
      name: "Tesla climate switch"
      hidden: false

# Create switch to turn on Tesla climate with Alexa
switch:
  - platform: template
    switches:
      tesla_climate:
        friendly_name: "Tesla climate switch"
        icon_template: mdi:car-seat-heater
        value_template: "{{ is_state('climate.matt_s_tesla_hvac_climate_system', 'heat_cool') }}"
        turn_on:
          service: climate.turn_on
          data:
            entity_id: climate.matt_s_tesla_hvac_climate_system
        turn_off:
          service: climate.turn_off
          data:
            entity_id: climate.matt_s_tesla_hvac_climate_system

sensor:
# Format sensor for lovelace
- platform: template
  sensors:
    master_in_bed:
      friendly_name: "Count in Bed (Int)"
      value_template: "{{ states('input_number.master_in_bed')|int }}"

# Monitor system performance
- platform: systemmonitor
  resources:
    - type: memory_use_percent
    - type: disk_use_percent
    - type: swap_use_percent
    - type: load_1m
    - type: load_5m
    - type: load_15m

# Add history to temp, humidity, and system monitor sensors
- platform: statistics
  entity_id: sensor.aqara_weather_temperature
  name: "Master Bathroom Temperature Stats (Aqara)"
- platform: statistics
  entity_id: sensor.aqara_weather_humidity
  name: "Master Bathroom Humidity Stats (Aqara)"

# Text to speech
tts:
  - platform: google_translate

# Includes
group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml
